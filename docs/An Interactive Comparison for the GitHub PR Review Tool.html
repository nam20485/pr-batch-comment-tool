<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Analysis: GitHub PR Tool Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Soothing & Professional -->
    <!-- Application Structure Plan: The SPA is structured as an interactive decision-support tool. It leads with the 'Final Recommendation' for quick insight, followed by a tabbed interface for deeper exploration into: 1. 'Side-by-Side Comparison' for at-a-glance evaluation. 2. An interactive 'Trade-off Visualizer' (Radar Chart) to make abstract concepts tangible. 3. A 'Core Requirements' summary for context. This non-linear structure is superior to the original report's format because it empowers users to compare options directly and explore based on their priorities (e.g., performance vs. development speed), rather than passively reading a linear document. Gemini API features have been added to provide deeper, generated explanations and actionable next steps (a kickstart plan), enhancing the tool's value. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Three architectural options -> Goal: Compare -> Viz: Three-column card layout and an interactive Radar Chart. Interaction: The chart visually maps each option's strengths across key criteria (Performance, Simplicity, etc.). Justification: This dual-format comparison caters to both qualitative (reading pros/cons) and quantitative (visualizing relative strengths) analysis, offering a richer understanding than text alone. Library: Chart.js (Canvas).
        - Report Info: Pros and Cons lists -> Goal: Inform -> Viz: Styled HTML lists within each card. Interaction: Contained within the larger comparison structure. Justification: Clear, scannable lists are the most effective way to present this information.
        - Report Info: Recommendation -> Goal: Persuade -> Viz: A prominent, highlighted callout section. Interaction: A new Gemini-powered button allows users to request a more detailed explanation. Justification: Emphasizes the key takeaway and adds a layer of AI-driven depth.
        - Report Info: Recommended Architecture -> Goal: Action -> Viz: A new Gemini-powered button on the recommended option's card. Interaction: Generates a high-level project kickstart plan. Justification: Turns the analysis into an actionable first step, significantly increasing the tool's utility.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .tab {
            transition: color 0.2s, border-color 0.2s;
        }
        .tab.active {
            color: #0ea5e9; /* sky-500 */
            border-bottom-color: #0ea5e9;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 50vh;
            max-height: 450px;
            width: 100%;
            max-width: 600px;
        }
        .loader {
            width: 24px;
            height: 24px;
            border: 3px solid #e2e8f0;
            border-top: 3px solid #38bdf8;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .prose h3 { margin-top: 1.5em; margin-bottom: 0.5em; font-size: 1.25rem; font-weight: 600; }
        .prose ul { list-style-position: inside; }
        .prose li { margin-left: 1rem; }
        .prose code { background-color: #e2e8f0; padding: 0.2em 0.4em; margin: 0; font-size: 85%; border-radius: 3px; }

    </style>
</head>
<body class="text-slate-700">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-slate-900">Architectural Analysis</h1>
            <p class="mt-3 text-lg text-slate-600 max-w-3xl mx-auto">An Interactive Comparison for the GitHub PR Review Tool</p>
        </header>

        <section id="recommendation" class="mb-12">
             <div class="max-w-4xl mx-auto bg-emerald-600 text-white p-8 rounded-2xl shadow-xl">
                <h2 class="text-3xl font-bold mb-4 flex items-center">
                    <span class="mr-3">⭐</span>
                    Final Recommendation: Option 2
                </h2>
                <p class="text-lg opacity-90">
                    The **Repository Pattern with a Local Cache** is the strongly recommended approach.
                </p>
                <p class="mt-3 opacity-90">
                    This architecture elevates the application from a simple utility to a professional-grade tool. While it requires more initial development, the long-term benefits of a snappy, responsive UI and crucial offline capabilities provide a superior user experience that aligns with the goal of improving developer productivity. It creates a robust, scalable, and maintainable foundation for future features.
                </p>
                <div class="mt-6">
                    <button id="explain-recommendation-btn" class="bg-white/20 hover:bg-white/30 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center">
                        ✨ Explain this recommendation
                    </button>
                    <div id="recommendation-explanation" class="mt-4 p-4 bg-emerald-700/50 rounded-lg text-emerald-50 hidden"></div>
                </div>
            </div>
        </section>

        <main>
            <div class="border-b border-slate-200 mb-8">
                <nav class="-mb-px flex justify-center space-x-4 sm:space-x-8" aria-label="Tabs">
                    <button class="tab active whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg" data-tab="comparison">Comparison</button>
                    <button class="tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg text-slate-500 hover:text-slate-700" data-tab="visualizer">Visualizer</button>
                    <button class="tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg text-slate-500 hover:text-slate-700" data-tab="requirements">Requirements</button>
                </nav>
            </div>

            <div id="tab-content-container">
                <div id="comparison" class="tab-content active">
                    <div class="text-center mb-10">
                        <h2 class="text-3xl font-bold text-slate-900">Side-by-Side Comparison</h2>
                        <p class="mt-2 text-slate-600 max-w-2xl mx-auto">Here's a direct look at the trade-offs for each architectural approach. The recommended option is highlighted.</p>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        
                        <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200 flex flex-col">
                            <h3 class="text-2xl font-bold text-slate-800 mb-3">1. Direct API Client</h3>
                            <p class="text-slate-500 mb-6 flex-grow">The most straightforward approach. Every user action triggers a live API call to GitHub.</p>
                            <div class="mb-4">
                                <h4 class="font-semibold text-emerald-700 mb-2">Pros</h4>
                                <ul class="list-disc list-inside space-y-1 text-sm">
                                    <li>Fastest development time</li>
                                    <li>Simple, linear logic</li>
                                    <li>Always shows live, current data</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold text-red-700 mb-2">Cons</h4>
                                <ul class="list-disc list-inside space-y-1 text-sm">
                                    <li>No offline functionality</li>
                                    <li>UI performance tied to network speed</li>
                                    <li>High risk of hitting API rate limits</li>
                                </ul>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-2xl border-2 border-emerald-500 flex flex-col ring-4 ring-emerald-500/20">
                            <h3 class="text-2xl font-bold text-slate-800 mb-3">2. Repository w/ Cache</h3>
                            <p class="text-slate-500 mb-6 flex-grow">An abstraction layer that intelligently caches data in a local database (SQLite) to improve performance and enable offline use.</p>
                            <div class="mb-4">
                                <h4 class="font-semibold text-emerald-700 mb-2">Pros</h4>
                                <ul class="list-disc list-inside space-y-1 text-sm">
                                    <li>Excellent, snappy UI performance</li>
                                    <li>Full offline viewing capability</li>
                                    <li>Easily testable and scalable</li>
                                    <li>Negligible API rate limit risk</li>
                                </ul>
                            </div>
                            <div class="mb-6">
                                <h4 class="font-semibold text-red-700 mb-2">Cons</h4>
                                <ul class="list-disc list-inside space-y-1 text-sm">
                                    <li>Higher initial development complexity</li>
                                    <li>Requires cache invalidation logic</li>
                                </ul>
                            </div>
                            <div class="mt-auto pt-4 border-t border-slate-200">
                                 <button id="generate-plan-btn" class="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center justify-center">
                                    ✨ Generate Kickstart Plan
                                </button>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200 flex flex-col">
                            <h3 class="text-2xl font-bold text-slate-800 mb-3">3. GraphQL API Client</h3>
                            <p class="text-slate-500 mb-6 flex-grow">Uses GitHub's GraphQL API to fetch exactly the data needed in a single, efficient network request.</p>
                            <div class="mb-4">
                                <h4 class="font-semibold text-emerald-700 mb-2">Pros</h4>
                                <ul class="list-disc list-inside space-y-1 text-sm">
                                    <li>Most network-efficient</li>
                                    <li>Reduces data payload size</li>
                                    <li>Powerful, complex queries possible</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold text-red-700 mb-2">Cons</h4>
                                <ul class="list-disc list-inside space-y-1 text-sm">
                                    <li>Steeper learning curve than REST</li>
                                    <li>Less mature tooling in .NET ecosystem</li>
                                    <li>Potentially overkill for this project</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="visualizer" class="tab-content">
                    <div class="text-center mb-10">
                        <h2 class="text-3xl font-bold text-slate-900">Trade-off Visualizer</h2>
                        <p class="mt-2 text-slate-600 max-w-2xl mx-auto">This chart visualizes the strengths of each option across key criteria. A larger area indicates a better score in that dimension.</p>
                    </div>
                    <div class="bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-slate-200">
                        <div class="chart-container">
                            <canvas id="architectureChart"></canvas>
                        </div>
                    </div>
                </div>

                <div id="requirements" class="tab-content">
                    <div class="text-center mb-10">
                        <h2 class="text-3xl font-bold text-slate-900">Core Application Requirements</h2>
                        <p class="mt-2 text-slate-600 max-w-2xl mx-auto">This project aims to build a powerful and intuitive tool for developers. The key features are outlined below.</p>
                    </div>
                    <div class="max-w-3xl mx-auto bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                        <ul class="space-y-4">
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-4 mt-1">✓</span>
                                <div><strong class="text-slate-800">Platform:</strong> A native-feel Windows Desktop App using Avalonia UI, with potential for future cross-platform expansion.</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-4 mt-1">✓</span>
                                <div><strong class="text-slate-800">Authentication:</strong> Secure GitHub login via OAuth2 device flow, with the token stored locally for seamless subsequent sessions.</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-4 mt-1">✓</span>
                                <div><strong class="text-slate-800">Navigation:</strong> An intuitive, searchable, multi-pane layout to navigate from repositories to pull requests to comment details efficiently.</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-4 mt-1">✓</span>
                                <div><strong class="text-slate-800">Comment Management:</strong> Robust filtering (by author, file, status) and sorting (by date, file) of all review comments.</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-4 mt-1">✓</span>
                                <div><strong class="text-slate-800">Batch Operations:</strong> A key productivity feature to select and duplicate comments, streamlining the process of re-iterating standard feedback.</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal for Kickstart Plan -->
    <div id="plan-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-xl font-semibold text-slate-800">Project Kickstart Plan</h3>
                <button id="close-modal-btn" class="text-slate-400 hover:text-slate-600">&times;</button>
            </div>
            <div id="modal-content" class="p-6 overflow-y-auto prose">
                <!-- Content will be injected here -->
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            const explainBtn = document.getElementById('explain-recommendation-btn');
            const explanationContainer = document.getElementById('recommendation-explanation');
            const generatePlanBtn = document.getElementById('generate-plan-btn');
            const planModal = document.getElementById('plan-modal');
            const modalContent = document.getElementById('modal-content');
            const closeModalBtn = document.getElementById('close-modal-btn');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetId = tab.dataset.tab;

                    tabs.forEach(t => {
                        t.classList.remove('active', 'text-sky-500');
                        t.classList.add('text-slate-500', 'hover:text-slate-700');
                    });
                    tab.classList.add('active', 'text-sky-500');
                    tab.classList.remove('text-slate-500', 'hover:text-slate-700');

                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === targetId) {
                            content.classList.add('active');
                        }
                    });
                });
            });

            const ctx = document.getElementById('architectureChart').getContext('2d');
            const chartData = {
                labels: ['Performance', 'Offline Support', 'Simplicity', 'Dev Speed', 'Scalability', 'Low API Usage'],
                datasets: [{
                    label: 'Direct API Client',
                    data: [3, 1, 9, 9, 4, 2],
                    fill: true,
                    backgroundColor: 'rgba(56, 189, 248, 0.2)', // sky-400
                    borderColor: 'rgb(56, 189, 248)',
                    pointBackgroundColor: 'rgb(56, 189, 248)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(56, 189, 248)'
                }, {
                    label: 'Repository w/ Cache',
                    data: [9, 9, 4, 5, 9, 9],
                    fill: true,
                    backgroundColor: 'rgba(16, 185, 129, 0.2)', // emerald-500
                    borderColor: 'rgb(16, 185, 129)',
                    pointBackgroundColor: 'rgb(16, 185, 129)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(16, 185, 129)'
                }, {
                    label: 'GraphQL API Client',
                    data: [6, 1, 6, 6, 7, 7],
                    fill: true,
                    backgroundColor: 'rgba(168, 85, 247, 0.2)', // purple-500
                    borderColor: 'rgb(168, 85, 247)',
                    pointBackgroundColor: 'rgb(168, 85, 247)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(168, 85, 247)'
                }]
            };

            const chartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                scales: { r: { angleLines: { color: '#cbd5e1' }, grid: { color: '#e2e8f0' }, pointLabels: { font: { size: 14 }, color: '#334155' }, ticks: { backdropColor: 'rgba(255, 255, 255, 0.75)', color: '#64748b', stepSize: 2 }, min: 0, max: 10 } },
                plugins: { legend: { position: 'top', labels: { color: '#334155' } }, tooltip: { backgroundColor: '#0f172a', titleColor: '#f8fafc', bodyColor: '#e2e8f0', padding: 10, cornerRadius: 4 } }
            };
            
            new Chart(ctx, { type: 'radar', data: chartData, options: chartOptions });

            async function callGemini(prompt) {
                const apiKey = ""; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                const payload = { contents: [{ parts: [{ text: prompt }] }] };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) {
                        throw new Error(`API Error: ${response.status}`);
                    }
                    const result = await response.json();
                    if (result.candidates && result.candidates[0].content.parts[0].text) {
                        return result.candidates[0].content.parts[0].text;
                    }
                    return "Sorry, the AI response was empty.";
                } catch (error) {
                    console.error("Gemini API call failed:", error);
                    return "An error occurred while contacting the AI. Please check the console.";
                }
            }

            explainBtn.addEventListener('click', async () => {
                explanationContainer.innerHTML = '<div class="loader mx-auto"></div>';
                explanationContainer.classList.remove('hidden');
                explainBtn.disabled = true;

                const prompt = "You are an expert software architect. Given three options for a GitHub client application (Direct API, Repository with Cache, GraphQL), explain in a few concise paragraphs why the 'Repository with Cache' approach is the superior choice for building a professional-grade, responsive, and robust desktop productivity tool. Emphasize the long-term user experience benefits over short-term development speed.";
                const explanation = await callGemini(prompt);
                explanationContainer.innerHTML = explanation.replace(/\n/g, '<br><br>');
                explainBtn.disabled = false;
            });

            function showModal() {
                planModal.classList.remove('hidden');
                planModal.classList.add('flex');
            }

            function hideModal() {
                planModal.classList.add('hidden');
                planModal.classList.remove('flex');
            }

            generatePlanBtn.addEventListener('click', async () => {
                modalContent.innerHTML = '<div class="loader mx-auto"></div>';
                showModal();
                
                const prompt = "You are a senior software engineer. Create a high-level project kickstart plan for building a C# Avalonia desktop application using the 'Repository Pattern with Local Cache' to interact with the GitHub API. The plan should be in Markdown format and include the following sections: 1. ### Project Structure (suggested projects in the .NET solution), 2. ### Key NuGet Packages (list essential libraries like Octokit, EF Core SQLite, etc.), 3. ### Core Classes & Interfaces (define interfaces like `IGitHubRepository` and classes like `GitHubApiService` and `LocalCacheService`), and 4. ### Development Phase 1 Tasks (a brief list of initial steps).";
                const plan = await callGemini(prompt);

                let html = plan
                    .replace(/### (.*$)/gm, '<h3>$1</h3>')
                    .replace(/\*\s\*\*(.*)\*\*/g, '<li><strong>$1</strong></li>')
                    .replace(/\*\s(.*)/g, '<li>$1</li>')
                    .replace(/`(.*?)`/g, '<code>$1</code>')
                    .replace(/\n/g, '<br>');

                modalContent.innerHTML = html;
            });

            closeModalBtn.addEventListener('click', hideModal);
            planModal.addEventListener('click', (e) => {
                if (e.target === planModal) {
                    hideModal();
                }
            });
        });
    </script>
</body>
</html>
